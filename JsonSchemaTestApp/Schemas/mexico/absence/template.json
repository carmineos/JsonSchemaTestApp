{
  "$id": "/mexico/absence",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "dateRange": {
      "$ref": "/common/dateRange"
    },
    "absenceReasons": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "affectingBalance": {
          "type": "boolean"
        },
        "medicalCertificateRequired": {
          "type": "boolean"
        }
      },
      "enum": [
        {
          "name": "Sick Leave",
          "affectingBalance": false,
          "medicalCertificateRequired": true
        },
        {
          "name": "Vacation",
          "affectingBalance": true,
          "medicalCertificateRequired": false
        }
      ]
    },
    "absenceTypes": {
      "type": "string",
      "enum": [
        "Half Day",
        "Full Day"
      ]
    }
  },
  "type": "object",
  "properties": {
    "requestData": {
      "type": "object",
      "properties": {
        "reasonDetails": {
          "title": "Reason",
          "$ref": "#/definitions/absenceReasons"
        },
        "medicalCertificate": {
          "title": "Medical Certificate",
          "type": "string",
          "format": "data-url"
        },
        "leavePeriod": {
          "$ref": "#/definitions/dateRange"
        },
        "type": {
          "title": "Type",
          "$ref": "#/definitions/absenceTypes"
        },
        "travelDays": {
          "title": "Travel Days",
          "type": "boolean"
        },
        "departurePeriod": {
          "$ref": "#/definitions/dateRange"
        },
        "arrivalPeriod": {
          "$ref": "#/definitions/dateRange"
        }
      },
      "required": [
        "reasonDetails",
        "leavePeriod",
        "type",
        "travelDays"
      ],
      "allOf": [
        {
          "if": {
            "properties": {
              "travelDays": { "const": true },
              "reasonDetails": {
                "properties": { "affectingBalance": { "const": true } }
              }
            }
          },
          "then": {
            "required": [ "departurePeriod", "arrivalPeriod" ]
          }
        }
      ]
    }
  },
  "required": [
    "requestData"
  ]
}